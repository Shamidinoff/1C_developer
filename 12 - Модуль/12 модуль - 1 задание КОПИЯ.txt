
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	//Вставить содержимое обработчика.
	//ПараметрыФормы = Новый Структура("", );
	//ОткрытьФорму("Документ.ПеремещениеТоваров.ФормаСписка", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);

	ТабДок = Новый ТабличныйДокумент; 
	Печать(ТабДок,ПараметрКоманды);
	ТабДок.Показать();

КонецПроцедуры 

Процедура Печать(ТабДок, Ссылка)
   Макет = Документы.ПеремещениеТоваров.ПолучитьМакет("ПеремещениеТоваров");
   
   	//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПеремещениеТоваров.Номер КАК Номер,
		|	ПеремещениеТоваров.Дата КАК Дата,
		|	ПеремещениеТоваров.СкладОтправитель КАК СкладОтправитель,
		|	ПеремещениеТоваров.СкладПолучатель КАК СкладПолучатель,
		|	ПеремещениеТоваров.Сотрудник КАК Сотрудник,
		|	ПеремещениеТоваров.Ссылка КАК Ссылка,
		|	ПеремещениеТоваров.Товар.(
		|		Ссылка КАК Ссылка,
		|		НомерСтроки КАК НомерСтроки,
		|		Номенклатура КАК Номенклатура,
		|		Количество КАК Количество,
		|		ЕдиницаИзмерения КАК ЕдиницаИзмерения
		|	) КАК Товар
		|ИЗ
		|	Документ.ПеремещениеТоваров КАК ПеремещениеТоваров
		|ГДЕ
		|	ПеремещениеТоваров.Ссылка = &СсылкаНаДокумент
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НазваниеОрганизация.Значение КАК Организация
		|ИЗ
		|	Константа.НазваниеОрганизация КАК НазваниеОрганизация";
	
	Запрос.УстановитьПараметр("СсылкаНаДокумент", Ссылка);
	
	Выборка = Запрос.ВыполнитьПакет();
	ДанныеТовара = Выборка[0];
	ДанныеОрганизации = Выборка[1];
	РезультатТовара = ДанныеТовара.Выбрать();
	РезультатОрганизации = ДанныеОрганизации.Выбрать();
	РезультатТовара.Следующий();
	РезультатОрганизации.Следующий();
	
	
	// Получение областей 
	
	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
   	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
   	ОбластьТело = Макет.ПолучитьОбласть("Тело");
   	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	
	ОбластьЗаголовок.Параметры.Номер = РезультатТовара.Номер;
	ОбластьЗаголовок.Параметры.Дата = РезультатТовара.Дата;
	ТабДок.Вывести(ОбластьЗаголовок); 
	
	ОбластьШапка.Параметры.Организация = РезультатТовара.Организация;
	ОбластьШапка.Параметры.СкладОтправитель = РезультатТовара.СкладОтправитель;
	ОбластьШапка.Параметры.СкладПолучатель = РезультатТовара.СкладПолучатель;
	ТабДок.Вывести(ОбластьШапка);
	
	ВыборкаТовары = РезультатТовара.Товар.Выбрать();
	Пока ВыборкаТовары Следующий() Цикл
		ОбластьТело.Параметры.НомерСтроки = ВыборкаТовары.НомерСтроки;
		ОбластьТело.Параметры.Номенклатура = ВыборкаТовары.Номенклатура;
		ОбластьТело.Параметры.Количество = ВыборкаТовары.Количество;
		ОбластьТело.Параметры.ЕдиницаИзмерения = ВыборкаТовары.ЕдиницаИзмерения;
		ТабДок.Вывести(ОбластьТело);	
	КонецЦикла;
	
	
	ОбластьПодвал.Параметры.ОтветственноеЛицо = РезультатОрганизации.Сотрудник;
	ТабДок.Вывести(ОбластьПодвал);

	
	
КонецПроцедуры         



















